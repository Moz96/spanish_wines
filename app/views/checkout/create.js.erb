document.addEventListener('DOMContentLoaded', function() {
  const stripe = Stripe('<%= Rails.application.credentials[:stripe][:public] %>');
  const checkoutButtons = document.querySelectorAll('.checkout-button');

  checkoutButtons.forEach(button => {
    button.addEventListener('click', () => {
      stripe.redirectToCheckout({
        sessionId: '<%= @session.id %>'
      })
      .then(result => {
        if (result.error) {
          alert(result.error.message);
        }
      });
    });
  });
});
